# Wrasse.sh

This is a very simple script that works on MikroTik's limited busy box. It searches for a subset of things that a bad person might do:

1. Loading /rw/lib/ shared objects from rw
2. Use the /rw/RESET file for persistence (pre-6.40.6)
3. Use the /rw/DEFCONF file for persistence
4. Use /rw/lib for basically anything
5. Use /flash/etc/rc.d for run script files (6.40.9 and below)

Not that these checks a very simplisitic and only intended to help the user dig deeper. They are by no means exhaustive.

One thing this does not check is that /pckg/ directories are not malicious. That would be pretty good to add.

## Usage

Usage is pretty easy. Just redirect standard error to /dev/null or you'll get some annoying stuff.

```sh
# ./wrasse.sh 2> /dev/null 
[+] Searching /proc/1...
[+] Searching /proc/175...
[+] Searching /proc/186...
[+] Searching /proc/187...
[+] Searching /proc/188...
[+] Searching /proc/189...
[+] Searching /proc/190...
[+] Searching /proc/191...
[+] Searching /proc/192...
[+] Searching /proc/193...
[+] Searching /proc/194...
[+] Searching /proc/196...
[+] Searching /proc/197...
[+] Searching /proc/198...
[+] Searching /proc/199...
[+] Searching /proc/200...
[+] Searching /proc/201...
[+] Searching /proc/202...
[+] Searching /proc/203...
[+] Searching /proc/204...
[+] Searching /proc/206...
[+] Searching /proc/207...
[+] Searching /proc/208...
[+] Searching /proc/211...
[+] Searching /proc/213...
[+] Searching /proc/217...
[+] Searching /proc/219...
[+] Searching /proc/220...
[+] Searching /proc/2302...
[+] Searching /proc/2303...
[+] Searching /proc/2879...
[+] Searching /proc/91...
[+] Searching /proc/self...
[!] Found /rw/RESET
[!] Found /rw/DEFCONF
[!] Found /rw/lib
[!] Found bad rc directory
```